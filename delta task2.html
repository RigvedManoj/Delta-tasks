<!DOCTYPE html>
<html>
	<head>
	</head>
  <style>
  body, canvas, html{margin:0;padding:0;border:0 none;}
  canvas{display: block;}
}
</style>
	<body>

		<div id="body">
		</div>
    <script type="text/javascript" src="http://code.jquery.com/jquery.min.js"></script>
		<script>
		   var randomx,randomy;
		    var i=0,j=50,x=700,y=300,count=0;
        var maze,brk=0,mazecount=0;
			var canvas = null;
			var context = null;
			var assets = ['robowalk00.png','robowalk01.png','robowalk02.png','robowalk03.png','robowalk04.png',
						  'robowalk05.png','robowalk06.png','robowalk07.png','robowalk08.png','robowalk09.png',
						  'robowalk10.png','robowalk11.png','robowalk12.png','robowalk13.png','robowalk15.png',
						  'robowalk16.png','robowalk17.png','robowalk18.png'];
			var frames = [],array = [];
			var frameCount = 0,  currentFrame =0, framerate = 1000/30, go;
			var right=0,down=0;
			var kl=0;
      var onMazeLoad= function(){
					for(var i1=-500;i1<=1800;i1+=100)
					for(var i2=-500;i2<=1200;i2+=100)
					{context.drawImage(maze,35,0,25,25,i1,i2,100,100);
	        array.push({x: i1, y: i2,val: "b"});
			}
			randomx=(Math.floor((Math.random()*21)-4))*100;
			if(randomx>=700&&randomx<=1000)
			randomx+=400;
			if(randomx<700&&randomx>=400)
			randomx-=400;
			randomy=(Math.floor((Math.random()*15)-4))*100;
			if(randomy>=300&&randomy<=600)
			randomy+=400;
			if(randomy<300&&randomy>=0)
			randomy-=400;
        while(1){
					context.drawImage(maze,0,0,30,30,700,300,100,100);
					mazecount++;
					for(var i1=0;i1<array.length;i1++)
	 			 if(array[i1].x==x&&array[i1].y==y)
	 			 array[i1].val="g";
				 var x1 = Math.floor(Math.random() * 4);
				 if(x1==0&&x<1700)
				 {x+=100;
					 context.drawImage(maze,0,0,30,30,x,y,100,100);
		 			 array.push({x: x, y: y,val: "g"});
				 }
				 if(x1==1&&x>-400)
				{x-=100;
					context.drawImage(maze,0,0,30,30,x,y,100,100);
					array.push({x: x, y: y,val: "g"});
				}
				if(x1==2&&y<1000)
				{y+=100;
					context.drawImage(maze,0,0,30,30,x,y,100,100);
					array.push({x: x, y: y,val: "g"});
				}
				if(x1==3&&y>-400)
				{y-=100;
					context.drawImage(maze,0,0,30,30,x,y,100,100);
					array.push({x: x, y: y,val: "g"});
				}
				for(var i1=0;i1<array.length;i1++)
				{
					if(array[i1].x==randomx&&array[i1].y==randomy)
					if(array[i1].val=="g")
					brk=1;
				}
				if(brk==1)
        {
					break;
				}
		}
				context.drawImage(maze,70,0,25,25,randomx,randomy,100,100);
				for(var i1=0;i1<array.length;i1++)
				if(array[i1].x==randomx&&array[i1].y==randomy)
				array[i1].val="g";
				;
      context.drawImage(frames[0],700,300,100,80);
		}
			var onImageLoad = function(){
				console.log("IMAGE!!!");
				frameCount++;
			};
			var setup = function() {
				body = document.getElementById('body');
				canvas = document.createElement('canvas');
				context = canvas.getContext('2d');

				canvas.width = window.innerWidth;
				canvas.height = window.innerHeight;
				body.appendChild(canvas);
                 for(var i=0; i < assets.length; i++){
					var img = new Image();
					img.onload = onImageLoad;
					img.src = assets[i];
					frames.push(img);
      }
       maze= new Image();
      maze.onload=onMazeLoad;
      maze.src="terrain1.png";
    };
			   window.onkeydown=move;
			   window.onkeyup=stop;
			   function stop()
			   {
					 window.onkeydown=move;
				   clearInterval(go);
					 if(randomx-right<=750&&randomx+100-right>=750&&randomy+100-down>=350&&randomy-down<=350)
			 			{context.font="30px Arial";
						context.clearRect(0,0,canvas.width,canvas.height);
			 			context.fillText("YOU WIN",700,300)
			 			window.onkeydown=null;
			 			window.onkeyup=null;
			 		}
			   }
                 function move(event)
                 {
                	 window.onkeydown=null;
                	var key=event.which||event.keyCode;
                if(key==68)
                		{
				go=setInterval(animate,framerate);}//50
                if(key==87)
                    {
         go=setInterval(animate3,framerate);}//35
               if(key==65)
                    {
          go=setInterval(animate4,framerate);}//48
                 if(key==83)
         		{
			     go=setInterval(animate2,framerate);}}//63
 function animate()
 {kl=0;
	 context.clearRect(0,0,canvas.width,canvas.height);
	 //console.log(array[0].x)
 	for(var i1=0;i1<array.length;i1++)
 	 {
 		 if(array[i1].x-right==780&&array[i1].y-down>=300&&array[i1].y-down<400)
 		 {
 			 if(array[i1].val=="b")
 		 kl=1;
	 }
 			if(array[i1].val=="g")
 		context.drawImage(maze,0,0,30,30,array[i1].x-right,array[i1].y-down,100,100);
 		else
		 if(array[i1].val=="b")
 		context.drawImage(maze,35,0,25,25,array[i1].x-right,array[i1].y-down,100,100);
 	}
 	 context.drawImage(maze,70,0,25,25,randomx-right,randomy-down,100,100);
 	 context.save();
  context.translate(700+50,300+40);
 	 context.rotate(0);
 	 context.drawImage(frames[currentFrame],-50,-40,100,80);
 currentFrame = (currentFrame == frameCount-1)? 0: currentFrame+1;
 context.restore();
 if(kl==0)
 right+=10;
 }
 function animate2()
 {kl=0;
	 context.clearRect(0,0,canvas.width,canvas.height);
	 for(var i1=0;i1<array.length;i1++)
		{
			if(array[i1].x-right>=650&&array[i1].x-right<750&&array[i1].y-down==400)
			{
				if(array[i1].val=="b")
			kl=1
		;}
			 if(array[i1].val=="g")
		 context.drawImage(maze,0,0,30,30,array[i1].x-right,array[i1].y-down,100,100);
		 else
		 context.drawImage(maze,35,0,25,25,array[i1].x-right,array[i1].y-down,100,100);
	 }
		context.drawImage(maze,70,0,25,25,randomx-right,randomy-down,100,100);
		context.save();
	context.translate(700+50,300+40);
		context.rotate(Math.PI/2);
		context.drawImage(frames[currentFrame],-50,-40,100,80);
 currentFrame = (currentFrame == frameCount-1)? 0: currentFrame+1;
 context.restore();
 if(kl==0)
 down+=10;
 }
 function animate3()
 {kl=0;
	 context.clearRect(0,0,canvas.width,canvas.height);
	 for(var i1=0;i1<array.length;i1++)
		{
			if(array[i1].x-right>=650&&array[i1].x-right<750&&array[i1].y-down==200)
			{
				if(array[i1].val=="b")
			kl=1
		;}
			 if(array[i1].val=="g")
		 context.drawImage(maze,0,0,30,30,array[i1].x-right,array[i1].y-down,100,100);
		 else
		 context.drawImage(maze,35,0,25,25,array[i1].x-right,array[i1].y-down,100,100);
	 }
		context.drawImage(maze,70,0,25,25,randomx-right,randomy-down,100,100);
		context.save();
	context.translate(700+50,300+40);
		context.rotate(-Math.PI/2);
		context.drawImage(frames[currentFrame],-50,-40,100,80);
 currentFrame = (currentFrame == frameCount-1)? 0: currentFrame+1;
 context.restore();
 if(kl==0)
 down-=10;
 }
 function animate4()
 {kl=0;
	context.clearRect(0,0,canvas.width,canvas.height);
	 for(var i1=0;i1<array.length;i1++)
  	 {
  		 if(array[i1].x-right==620&&array[i1].y-down>=300&&array[i1].y-down<400)
  		 {
  			 if(array[i1].val=="b")
  		 kl=1
			 ;}
  			if(array[i1].val=="g")
  		context.drawImage(maze,0,0,30,30,array[i1].x-right,array[i1].y-down,100,100);
  		else
  		context.drawImage(maze,35,0,25,25,array[i1].x-right,array[i1].y-down,100,100);
  	}
  	 context.drawImage(maze,70,0,25,25,randomx-right,randomy-down,100,100);
  	 context.save();
   context.translate(700+50,300+40);
  	 context.rotate(Math.PI);
  	 context.drawImage(frames[currentFrame],-50,-40,100,80);
  currentFrame = (currentFrame == frameCount-1)? 0: currentFrame+1;
  context.restore();
 if(kl==0)
 right-=10;
 }
			setup();
		</script>
	</body>
</html>
